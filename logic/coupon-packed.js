$(document).ready(function(){$("#getCoupon").click(function(){Coupon.checkCode()})});var Coupon=new Object;Coupon={checkCode:function(){var e=$("#couponCode").val();var t=$("#meth").html();var n=$("#shipRate").html();n=n.replace(/\$/g,"");$.post("logic/coupon_f.php",{couponCode:e,requestType:"ajax"},function(t){$("#couponErr").remove();$("#couponMsg").remove();if(t.status=="failure"){Coupon.invalidCode(t)}else{Coupon.updateCart(t);if(e=="freeship"&&t.total_discount==0)Coupon.freeShip(t);if(t.total_discount>0)$("#getCoupon").unbind("click")}},"json")},invalidCode:function(e){var t='<p id="couponErr" style="display:none"><span>'+e.msg+"</span></p>";$("#couponMsg").remove();$("#getCoupon").parent().after(t);$("#couponErr").fadeIn()},updateCart:function(e){var t='<p id="couponMsg">'+e.msg+'<span id="couponDiscount">-$'+e.total_discount.toFixed(2)+"</span></p>";$("#getCoupon").parent().after(t);if(isNaN($("#shipRate").html())==false){$("#shipRate").hide();$("#shipRate").html(parseFloat($("#shipRate").html())-parseFloat(e.shipping_discount));$("#shipRate").html(parseFloat($("#shipRate").html()).toFixed(2)).fadeIn()}$("#gTotal").hide();var n=parseFloat($("#gTotal").html())-parseFloat(e.total_discount);n=n.toFixed(2);$("#gTotal").html(n).fadeIn();$("#gtotal").val(n)},freeShip:function(e){e.msg="Please click MODIFY SHIPPING to view discount";Coupon.invalidCode(e)}}
